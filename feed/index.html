<?xml version='1.0' encoding='UTF-8'?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" version="2.0"><channel><title>刘看山的博客</title><link>https://liukanshan.club/</link><description>学问之道无他，求其放心而已!</description><docs>http://www.rssboard.org/rss-specification</docs><generator>python-feedgen</generator><image><url>https://cdn.jsdelivr.net/gh/Kanshan28/Blog@gh-pages/logo.png</url><title>刘看山的博客</title><link>https://liukanshan.club/</link></image><language>zh-CN</language><lastBuildDate>Sun, 10 May 2020 15:56:34 +0806</lastBuildDate><pubDate>Sun, 10 May 2020 15:56:34 +0806</pubDate><item><title>Hello World!</title><link>https://liukanshan.club/archives/typography/</link><description>&lt;div class="notice"&gt;这是一篇示例文章，在这里你可以看到常用页面元素的显示效果，同时也是 Markdown 语法的参考文章。保留或者删除本文，开始自己的创作吧！&lt;/div&gt;&lt;h2&gt;L2 Heading&lt;/h2&gt;
&lt;h3&gt;L3 Heading&lt;/h3&gt;
&lt;h4&gt;L4 Heading&lt;/h4&gt;
&lt;h5&gt;L5 Heading&lt;/h5&gt;
&lt;h6&gt;L6 Heading&lt;/h6&gt;
&lt;h2&gt;Paragraph&lt;/h2&gt;
&lt;p&gt;We are creating a world that all may enter without privilege or prejudice accorded by race, economic power, military force, or station of birth.&lt;/p&gt;
&lt;p&gt;We are creating a world where anyone, anywhere may express his or her beliefs, no matter how singular, without fear of being coerced into silence or conformity.&lt;/p&gt;
&lt;h2&gt;Inline elements&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Bold&lt;/strong&gt;, &lt;ruby&gt;Ruby&lt;rp&gt;(&lt;/rp&gt;&lt;rt&gt;ルビ&lt;/rt&gt;&lt;rp&gt;)&lt;/rp&gt;&lt;/ruby&gt;, &lt;em&gt;Italic&lt;/em&gt;, &lt;del&gt;Strikethrough&lt;/del&gt;, &lt;a href="https://www.imalan.cn"&gt;Link&lt;/a&gt;&lt;sup id="fn_ref_1"&gt;&lt;a href="#fn_1"&gt;1&lt;/a&gt;&lt;/sup&gt;。&lt;/p&gt;
&lt;h2&gt;Blockquote and nested blockquote&lt;/h2&gt;
&lt;blockquote&gt;&lt;p&gt;安得广厦千万间，大庇天下寒士俱欢颜！风雨不动安如山。&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;呜呼！何时眼前突兀见此屋，吾庐独破受冻死亦足！&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;h2&gt;Code&lt;/h2&gt;
&lt;p&gt;Inline code: &lt;code&gt;int a=1;&lt;/code&gt;. Code block:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt; &lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
    &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;cout&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Hello World!&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;List&lt;/h2&gt;
&lt;h3&gt;Unordered List&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;iPhone&lt;ul&gt;
&lt;li&gt;iPhone X&lt;/li&gt;
&lt;li&gt;iPhone 11&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;iPad&lt;/li&gt;
&lt;li&gt;MacBook&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Ordered List&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;打开冰箱&lt;ol&gt;
&lt;li&gt;右手放在冰箱门拉手上&lt;/li&gt;
&lt;li&gt;左手扶住冰箱主体&lt;/li&gt;
&lt;li&gt;右手向后用力&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;把大象放进冰箱&lt;/li&gt;
&lt;li&gt;关上冰箱&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Horizontal rule&lt;/h2&gt;
&lt;hr&gt;
&lt;h2&gt;Math&lt;/h2&gt;
&lt;p&gt;Inline Math: $m\times n$, math block:&lt;/p&gt;
&lt;p&gt;$$C_{m\times k}=A_{m\times n}\cdot B_{n\times k}$$&lt;/p&gt;
&lt;h2&gt;Figures&lt;/h2&gt;
&lt;h3&gt;Single figure&lt;/h3&gt;
&lt;p&gt;&lt;figure style="flex: 92.88888888888889" &gt;&lt;img width="836" height="450" src="https://cdn.jsdelivr.net/gh/Kanshan28/Blog@gh-pages/archives/assets/e0affbc80ccb2d596c87b520e37e7071.jpg" /&gt;&lt;figcaption&gt;Princess Mononoke&lt;/figcaption&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3&gt;Photoset&lt;/h3&gt;
&lt;div class="photos"&gt;
&lt;figure style="flex: 75.0" &gt;&lt;img width="4032" height="2688" src="https://cdn.jsdelivr.net/gh/Kanshan28/Blog@gh-pages/archives/assets/4956a144888cdbbb6c2df1d1d15384b0.jpeg" /&gt;&lt;/figure&gt;
![][1]
&lt;figure style="flex: 75.0" &gt;&lt;img width="4032" height="2688" src="https://cdn.jsdelivr.net/gh/Kanshan28/Blog@gh-pages/archives/assets/8b4d2334469ffa39b59e6fdb37c8c601.jpeg" /&gt;&lt;/figure&gt;&lt;/div&gt;&lt;div class="photos"&gt;
&lt;figure style="flex: 75.0" &gt;&lt;img width="4032" height="2688" src="https://cdn.jsdelivr.net/gh/Kanshan28/Blog@gh-pages/archives/assets/0f5023d542a33e7c9d270f3cd6a99562.jpeg" /&gt;&lt;/figure&gt;
&lt;figure style="flex: 75.0" &gt;&lt;img width="4032" height="2688" src="https://cdn.jsdelivr.net/gh/Kanshan28/Blog@gh-pages/archives/assets/20ec69d2a0276336f95e11f42866d17f.jpeg" /&gt;&lt;/figure&gt;
&lt;figure style="flex: 75.0" &gt;&lt;img width="4032" height="2688" src="https://cdn.jsdelivr.net/gh/Kanshan28/Blog@gh-pages/archives/assets/2b8af25285e5a193729a350593113bad.jpeg" /&gt;&lt;/figure&gt;&lt;/div&gt;&lt;h2&gt;Table&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;&lt;tr&gt;
&lt;th&gt;header&lt;/th&gt;
&lt;th&gt;header&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;cell 1&lt;/td&gt;
&lt;td&gt;cell 2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cell 3&lt;/td&gt;
&lt;td&gt;cell 4&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;&lt;div class="footnotes"&gt;&lt;ol&gt;&lt;li id="fn_1"&gt;Home page for AlanDecode &lt;a no-style href="#fn_ref_1"&gt;↩&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;</description><author>kansha_liu@foxmail.com (Kanshan)</author><guid isPermaLink="true">https://liukanshan.club/archives/typography/</guid><pubDate>Wed, 29 Apr 2020 19:10:00 +0806</pubDate></item><item><title>Shell中if的-e,-d,-f使用</title><link>https://liukanshan.club/archives/2020-04-30-Linux-shell中if的使用/</link><description>&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;文件比较运算符&lt;/strong&gt; &lt;code&gt;if [参数]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For example&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;if [ -e /etc/systemd/system/getty@tty1.service.d ]
then
    echo "login file is exist"
else
    mkdir "/etc/systemd/system/getty@tty1.service.d"
fi&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;&lt;tr&gt;
&lt;th style="text-align:center"&gt;序号&lt;/th&gt;
&lt;th style="text-align:center"&gt;参数&lt;/th&gt;
&lt;th style="text-align:center"&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;1&lt;/td&gt;
&lt;td style="text-align:center"&gt;-e filename&lt;/td&gt;
&lt;td style="text-align:center"&gt;如果 filename存在，则为真&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;2&lt;/td&gt;
&lt;td style="text-align:center"&gt;-d filename&lt;/td&gt;
&lt;td style="text-align:center"&gt;如果 filename为目录，则为真&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;3&lt;/td&gt;
&lt;td style="text-align:center"&gt;-f filename&lt;/td&gt;
&lt;td style="text-align:center"&gt;如果 filename为常规文件，则为真&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;4&lt;/td&gt;
&lt;td style="text-align:center"&gt;-L filename&lt;/td&gt;
&lt;td style="text-align:center"&gt;如果 filename为符号链接，则为真&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;5&lt;/td&gt;
&lt;td style="text-align:center"&gt;-r filename&lt;/td&gt;
&lt;td style="text-align:center"&gt;如果 filename可读，则为真&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;6&lt;/td&gt;
&lt;td style="text-align:center"&gt;-w filename&lt;/td&gt;
&lt;td style="text-align:center"&gt;如果 filename可写，则为真&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;7&lt;/td&gt;
&lt;td style="text-align:center"&gt;-x filename&lt;/td&gt;
&lt;td style="text-align:center"&gt;如果 filename可执行，则为真&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;8&lt;/td&gt;
&lt;td style="text-align:center"&gt;-s filename&lt;/td&gt;
&lt;td style="text-align:center"&gt;如果文件长度不为0，则为真&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;9&lt;/td&gt;
&lt;td style="text-align:center"&gt;-h filename&lt;/td&gt;
&lt;td style="text-align:center"&gt;如果文件是软链接，则为真&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;10&lt;/td&gt;
&lt;td style="text-align:center"&gt;file1 -nt file2&lt;/td&gt;
&lt;td style="text-align:center"&gt;如果 file1比 file2新，则为真&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;1&lt;/td&gt;
&lt;td style="text-align:center"&gt;file1 -ot file2&lt;/td&gt;
&lt;td style="text-align:center"&gt;如果 file1比 file2旧，则为真&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;整数变量表达式&lt;/strong&gt;&lt;code&gt;if [参数]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;&lt;tr&gt;
&lt;th style="text-align:center"&gt;序号&lt;/th&gt;
&lt;th style="text-align:center"&gt;参数&lt;/th&gt;
&lt;th style="text-align:center"&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;1&lt;/td&gt;
&lt;td style="text-align:center"&gt;-eq&lt;/td&gt;
&lt;td style="text-align:center"&gt;等于&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;2&lt;/td&gt;
&lt;td style="text-align:center"&gt;-ne&lt;/td&gt;
&lt;td style="text-align:center"&gt;不等于&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;3&lt;/td&gt;
&lt;td style="text-align:center"&gt;-gt&lt;/td&gt;
&lt;td style="text-align:center"&gt;大于&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;4&lt;/td&gt;
&lt;td style="text-align:center"&gt;-ge&lt;/td&gt;
&lt;td style="text-align:center"&gt;大于等于&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;5&lt;/td&gt;
&lt;td style="text-align:center"&gt;-lt&lt;/td&gt;
&lt;td style="text-align:center"&gt;小于&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;6&lt;/td&gt;
&lt;td style="text-align:center"&gt;-le&lt;/td&gt;
&lt;td style="text-align:center"&gt;小于等于&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;字符串变量表达式&lt;/strong&gt; &lt;code&gt;if [参数]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;&lt;tr&gt;
&lt;th style="text-align:center"&gt;序号&lt;/th&gt;
&lt;th style="text-align:center"&gt;参数&lt;/th&gt;
&lt;th style="text-align:center"&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;1&lt;/td&gt;
&lt;td style="text-align:center"&gt;&lt;code&gt;$a=$b&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align:center"&gt;如果string1等于string2，则为真&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;2&lt;/td&gt;
&lt;td style="text-align:center"&gt;&lt;code&gt;$string1 !=  $string2&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align:center"&gt;如果string1不等于string2，则为真&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;3&lt;/td&gt;
&lt;td style="text-align:center"&gt;&lt;code&gt;-n $string&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align:center"&gt;如果string 非空(非0），返回0(true)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;4&lt;/td&gt;
&lt;td style="text-align:center"&gt;&lt;code&gt;-z $string&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align:center"&gt;如果string 为空，则为真&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;5&lt;/td&gt;
&lt;td style="text-align:center"&gt;&lt;code&gt;$sting&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align:center"&gt;如果string 非空，返回0 (和-n类似)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;6&lt;/td&gt;
&lt;td style="text-align:center"&gt;&lt;code&gt;! 表达式&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align:center"&gt;条件表达式的相反[逻辑非]&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;7&lt;/td&gt;
&lt;td style="text-align:center"&gt;&lt;code&gt;表达式1  –a  表达式2&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align:center"&gt;条件表达式的并列[逻辑与]&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;8&lt;/td&gt;
&lt;td style="text-align:center"&gt;&lt;code&gt;表达式1  –o  表达式2&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align:center"&gt;条件表达式的或[逻辑或]&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;特殊变量&lt;/strong&gt; &lt;code&gt;if [参数]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;&lt;tr&gt;
&lt;th style="text-align:center"&gt;序号&lt;/th&gt;
&lt;th style="text-align:center"&gt;参数&lt;/th&gt;
&lt;th style="text-align:center"&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;1&lt;/td&gt;
&lt;td style="text-align:center"&gt;$0&lt;/td&gt;
&lt;td style="text-align:center"&gt;当前脚本的文件名&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;2&lt;/td&gt;
&lt;td style="text-align:center"&gt;$n&lt;/td&gt;
&lt;td style="text-align:center"&gt;传递给脚本或函数的参数。n 是一个数字，表示第几个参数。例如，第一个参数是$1，第二个参数是$2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;3&lt;/td&gt;
&lt;td style="text-align:center"&gt;$#&lt;/td&gt;
&lt;td style="text-align:center"&gt;传递给脚本或函数的参数个数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;4&lt;/td&gt;
&lt;td style="text-align:center"&gt;$*&lt;/td&gt;
&lt;td style="text-align:center"&gt;传递给脚本或函数的所有参数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;5&lt;/td&gt;
&lt;td style="text-align:center"&gt;$@&lt;/td&gt;
&lt;td style="text-align:center"&gt;传递给脚本或函数的所有参数。被双引号(" ")包含时，与 $* 稍有不同&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;6&lt;/td&gt;
&lt;td style="text-align:center"&gt;$?&lt;/td&gt;
&lt;td style="text-align:center"&gt;上个命令的退出状态，或函数的返回值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;7&lt;/td&gt;
&lt;td style="text-align:center"&gt;$$&lt;/td&gt;
&lt;td style="text-align:center"&gt;当前Shell进程ID。对于 Shell 脚本，就是这些脚本所在的进程ID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:center"&gt;8&lt;/td&gt;
&lt;td style="text-align:center"&gt;$!&lt;/td&gt;
&lt;td style="text-align:center"&gt;Shell最后运行的后台Process的PID(后台运行的最后一个进程的&lt;a href="https://www.baidu.com/s?wd=%E8%BF%9B%E7%A8%8BID&amp;amp;tn=SE_PcZhidaonwhc_ngpagmjz&amp;amp;rsv_dl=gh_pc_zhidao"&gt;进程ID&lt;/a&gt;号)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;参考处[&lt;code&gt;Shell特殊变量：Shell $0, $#, $*, $@, $?, $$和命令行参数&lt;/code&gt;]&lt;/li&gt;
&lt;/ul&gt;
</description><author>kansha_liu@foxmail.com (Kanshan)</author><guid isPermaLink="true">https://liukanshan.club/archives/2020-04-30-Linux-shell中if的使用/</guid><pubDate>Thu, 30 Apr 2020 22:55:00 +0806</pubDate></item><item><title>阳明心学及其现代意义-王德峰</title><link>https://liukanshan.club/archives/2020-05-03-WangYangming/</link><description>&lt;p&gt;&lt;a href="https://www.bilibili.com/video/BV1aQ4y1N78a"&gt;王阳明心学及其现代意义--上(点击观看)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.bilibili.com/video/BV16f4y1m7cc"&gt;王阳明心学及其现代意义--下（点击观看）&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;如下笔记：&lt;/p&gt;
&lt;h4&gt;王阳明心学及其现代意义-上&lt;/h4&gt;
&lt;p&gt;《传习录》----必读书籍（王阳明）&lt;/p&gt;
&lt;p&gt;人生有命：一个人到了40岁还不相信人生有命，此人悟性太差。   -----王德峰&lt;/p&gt;
&lt;p&gt;孟子：人生总是有所求。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;求则得之，舍则失之，是求有益于得也，求在于我也。&lt;/li&gt;
&lt;li&gt;求之有道，得之有命，是求无益于得也，求在外者也。&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;中国哲学的根本特征&lt;/h5&gt;
&lt;p&gt;人最难对付的是我们的生命的问题，我们的现实生命到处都是麻烦，佛家讲现实世界叫 &lt;strong&gt;尘世&lt;/strong&gt; （尘：灰尘，又引申为烦恼）。&lt;/p&gt;
&lt;p&gt;生命的外部麻烦，容易对付，生命的内部麻烦最难对付，就是我们内心的安定&lt;/p&gt;
&lt;p&gt;孔子在《论语》中这样说：不仁者，不可以久处约，不可以长处乐。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;约：这里指节约的，贫贱的生活处境。&lt;/li&gt;
&lt;li&gt;乐：这里指快乐的生活处境。&lt;/li&gt;
&lt;li&gt;不仁者：心没有安顿好的人。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;人生的问题来源于我们有&lt;strong&gt;无限心&lt;/strong&gt;：我们以筹划着未来的方式活在当下，我们去筹划还不存在的未来，证明人心有无限的一面，烦恼自从此中出，同时人生的精彩也来源于未来。我们的无限心，无法安放在有限的事物中，因为现实中的事无一不是有限的事。&lt;/p&gt;
&lt;h5&gt;以下为孟子心学和禅宗心学&lt;/h5&gt;
&lt;p&gt;我们如何安放无限心：以出世的精神入世&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;第一步要超越现实世界：出世&lt;/li&gt;
&lt;li&gt;第二步：入世&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;出世而后入世：儒、道、佛&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;儒家：无所为而为   （为：做事情） &lt;ul&gt;
&lt;li&gt;人生在世，不能不做事情，不做事情的人生不能算人生&lt;/li&gt;
&lt;li&gt;针对的是有所为而为，做事都有目标目的&lt;/li&gt;
&lt;li&gt;我们之所以做这件事，因为它本应当做，不做是不对的，这样的人生没有失败&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;道家：无为而无不为  （无为：不人为的做事（人为--&amp;gt;伪，造作））&lt;ul&gt;
&lt;li&gt;道家教我们做减法，减去人为的因素，做减法，顺应天道 &lt;/li&gt;
&lt;li&gt;儒道两家“天人合一”的重点不同，儒在人，道在天&lt;/li&gt;
&lt;li&gt;“身非贵之所能存，身非爱之所能厚”&lt;/li&gt;
&lt;li&gt;顺应天道： 已饥方食 未饱先止&lt;/li&gt;
&lt;li&gt;老庄也没法正面说道是什么，只能说道不是什么，读老庄获得做减法的方法&lt;/li&gt;
&lt;li&gt;道可道，非常道   --《道德经》&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;佛家：无心而为&lt;ul&gt;
&lt;li&gt;做事就是为了消业&lt;/li&gt;
&lt;li&gt;做事不求结果，但是做事总会有结果，所以要做事，但结果和自己无关&lt;/li&gt;
&lt;li&gt;认真做事，对结果不关心&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;心学开端：孟子学说&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;恻隐之心，人皆有之（仁之端）&lt;ul&gt;
&lt;li&gt;例子：孩童落井，本来我们与之形骸间隔，但这时我们怵惕恻隐之心生起，仁心感通，叫做一体之仁。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;羞恶之心，人皆有之&lt;/li&gt;
&lt;li&gt;辞让之心，人皆有之&lt;/li&gt;
&lt;li&gt;是非之心，人皆有之&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;“学问之道无他，求其放心而已”    ——孟子&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;已经亡失掉了的心，再把它召回来。&lt;/li&gt;
&lt;li&gt;放心：放出去的心&lt;/li&gt;
&lt;li&gt;求：召&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;阳明心学&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;心即理   （阳明学第一命理）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;禅宗宗旨：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;教外别传&lt;/li&gt;
&lt;li&gt;不立文字&lt;/li&gt;
&lt;li&gt;直指人心&lt;/li&gt;
&lt;li&gt;见性成佛&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;金刚经核心：应无所住，而生其心。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;住：镜像&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;王阳明心学及其现代意义-下&lt;/h4&gt;
&lt;p&gt;无蕴：色、受、想、行、识&lt;/p&gt;
&lt;p&gt;此心光明，亦复何言     ——王阳明&lt;/p&gt;
&lt;p&gt;惠能悟道：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;何其自性，本自清净&lt;/li&gt;
&lt;li&gt;何其自性，本无生灭&lt;/li&gt;
&lt;li&gt;何其自性，本不动摇&lt;/li&gt;
&lt;li&gt;何其自性，本自具足&lt;/li&gt;
&lt;li&gt;&lt;p&gt;何其自性，能生万法&lt;/p&gt;
&lt;p&gt;见性是功，平等是德   ——惠能&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;众生是尚未觉悟了的佛，佛是觉悟了的众生&lt;/p&gt;
&lt;p&gt;即心即佛   ——禅宗&lt;/p&gt;
&lt;p&gt;破山中贼易，破心中贼难。  ——王阳明&lt;/p&gt;
&lt;h5&gt;什么是阳明心学？&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;心即礼&lt;ul&gt;
&lt;li&gt;四书之《大学》：初学入德之门&lt;ul&gt;
&lt;li&gt;大学之道，在明明德，在亲民，在止于至善   （三纲领）&lt;ul&gt;
&lt;li&gt;大学：大人之学，学做君子&lt;/li&gt;
&lt;li&gt;按照孔子的说法，15岁开始学习君子的境界&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;格物、致知、诚意、正心、修身、齐家、治国、平天下  （八条目）&lt;ul&gt;
&lt;li&gt;格物：对事情、事物进行观察和理解  （从外部事物中发现真理）&lt;/li&gt;
&lt;li&gt;王阳明后来龙场悟道：自性具足，心无外物。  （阳明心学从自性出发，开始和朱熹的格物对立）&lt;/li&gt;
&lt;li&gt;朱熹破心中之贼方法：存天理，灭人欲 (僵死的教条)&lt;/li&gt;
&lt;li&gt;王阳明破心中之贼方法：良知即是天理&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;致良知&lt;ul&gt;
&lt;li&gt;致：听&lt;/li&gt;
&lt;li&gt;如何听？&lt;ul&gt;
&lt;li&gt;无私欲之蔽，无理性之蔽&lt;/li&gt;
&lt;li&gt;在生命实践中行&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;知行合一&lt;ul&gt;
&lt;li&gt;知是行之始，行是知之成&lt;/li&gt;
&lt;li&gt;三不朽圣人王阳明：立功、立德、立言&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description><author>kansha_liu@foxmail.com (Kanshan)</author><guid isPermaLink="true">https://liukanshan.club/archives/2020-05-03-WangYangming/</guid><pubDate>Sun, 03 May 2020 10:08:00 +0806</pubDate></item><item><title>用Pyhton实现的高可用IP代理池</title><link>https://liukanshan.club/archives/2020-05-09-Proxy_Pool/</link><description>&lt;p&gt;1.代理池概述&lt;/p&gt;
&lt;h5&gt;1.1什么是代理池&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;代理池就是代理Ip组成的池子，它可以提供稳定可用的代理IP&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;1.2为什么要实现代理池&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;我们在做爬虫的时候，最常见的一种反爬手段，就是IP反爬，常见的解决方法就是用代理IP方案&lt;/li&gt;
&lt;li&gt;代理IP非常不稳定，可用性10%可能都不到&lt;/li&gt;
&lt;li&gt;从一堆不稳定的代理IP中抽取出可用代理IP，给爬虫使用。&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;1.3代理池开发环境&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;平台：MAC,Windows,Linux&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;开发语言：Python3&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;开发工具：PyCharm&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;使用到的主要技术：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;requests：发送请求，获取页面数据&lt;/li&gt;
&lt;li&gt;lxml：使用XPATH从页面回去我们想要的数据&lt;/li&gt;
&lt;li&gt;pymongo：把提取到的代理IP存储到MongoDB数据库中和从MongoDB数据库中读取代理IP给爬虫使用&lt;/li&gt;
&lt;li&gt;Flask：用于提供WEB服务&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;####&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;2.代理池的设计&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;目标：理解代理池的工作流程和各个模块的作用&lt;/li&gt;
&lt;li&gt;内容介绍&lt;ul&gt;
&lt;li&gt;代理池的工作流程&lt;/li&gt;
&lt;li&gt;代理池的模块及其作用&lt;/li&gt;
&lt;li&gt;代理池的项目结构&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;2.1代理池的工作流程&lt;/h5&gt;
&lt;p&gt;&lt;figure style="flex: 75.0" &gt;&lt;img width="540" height="360" src="https://cdn.jsdelivr.net/gh/Kanshan28/Blog@gh-pages/archives/assets/00a0e75d93ca1c2ae0255bbcbe00424c.png" /&gt;&lt;figcaption&gt;代理池的工作流程&lt;/figcaption&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;代理池工作流程文字描述&lt;ul&gt;
&lt;li&gt;代理IP采集模块--&amp;gt;采集代理IP --&amp;gt;如果不可用，直接过滤掉，如果可用，制定默认分数--&amp;gt;存入数据库&lt;/li&gt;
&lt;li&gt;代理IP检测模块--&amp;gt;从数据库中获取所有代理IP--&amp;gt;检测代理IP--&amp;gt;如果代理IP不可用，就把分数-1，如果的分数为0，就从数据库中删除，否则更新数据库；如果代理IP可用，则恢复为默认分值，更新数据库。&lt;/li&gt;
&lt;li&gt;代理API模块--&amp;gt;数据库中高可用的代理IP给爬虫使用&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;2.2 代理模块及其作用&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;代理池分为5大核心模块&lt;ul&gt;
&lt;li&gt;爬虫模块：采集代理IP&lt;ul&gt;
&lt;li&gt;从代理IP网站上采集代理IP&lt;/li&gt;
&lt;li&gt;进行校验（获取代理响应速度，协议类型，匿名类型）&lt;/li&gt;
&lt;li&gt;把可用的代理IP存储到数据库中&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;代理IP的检验模块：获取指定代理的响应速度，支持的协议以及匿名程度&lt;ul&gt;
&lt;li&gt;原因：网站上所标注的响应速度，协议类型是不准确的&lt;/li&gt;
&lt;li&gt;这里使用httpbin.org进行检测&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;数据库模块：实现对代理IP的增删改查操作&lt;ul&gt;
&lt;li&gt;这里使用MongoDB来存储代理IP&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;检测模块：定时对代理池中代理进行检测，确保代理池中代理的可用性&lt;ul&gt;
&lt;li&gt;从数据库读取所有的代理IP&lt;/li&gt;
&lt;li&gt;对代理IP进行逐一检测，可用开启多个协程，以提高检测速度&lt;/li&gt;
&lt;li&gt;如果该代理不可用，就让这个代理分数-1，当代理的分数到0了，就删除该代理，如果检测到代理可用就恢复为满分&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;代理IP服务接口：提供高可用代理IP给爬虫使用&lt;ul&gt;
&lt;li&gt;根据协议类型和域名获取随机的高质量代理IP&lt;/li&gt;
&lt;li&gt;根据协议类型和域名获取多个高质量代理IP&lt;/li&gt;
&lt;li&gt;根据代理IP，不可用域名，告诉代理池这个代理IP在该域名下不可用，下次获取这个域名时就不会再用这个代理IP了，从而保证代理IP的高可用&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;其他模块&lt;ul&gt;
&lt;li&gt;数据模型：domain.py&lt;ul&gt;
&lt;li&gt;代理IP的数据模型，用于封装代理IP的相关信息，如ip,端口，响应速度，协议类型，匿名类型，分数等。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;程序启动入口：main.py&lt;ul&gt;
&lt;li&gt;代理池提供一个统一的启动入口&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;工具模块&lt;ul&gt;
&lt;li&gt;日志模块：用于记录日志信息&lt;/li&gt;
&lt;li&gt;http模块：用于获取随机User-Agent的请求头&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;配置文件：setting&lt;ul&gt;
&lt;li&gt;用于默认代理的分数，配置日志格式，文件，启动的爬虫，检验的时间等&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;2.3 代理池的项目结构&lt;/h5&gt;
&lt;p&gt;&lt;figure style="flex: 58.66983372921615" &gt;&lt;img width="494" height="421" src="https://cdn.jsdelivr.net/gh/Kanshan28/Blog@gh-pages/archives/assets/006ef0d2e083206e9d70fb033a7582c7.png" /&gt;&lt;figcaption&gt;代理池的项目结构&lt;/figcaption&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4&gt;3.实现代理池的思路&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;目标：明确代理池实现思路&lt;/li&gt;
&lt;li&gt;步骤：&lt;ul&gt;
&lt;li&gt;介绍实现项目的两种思路&lt;/li&gt;
&lt;li&gt;对比两种实现思路&lt;/li&gt;
&lt;li&gt;明确代理池采用实现思路&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;实现项目的两种思路&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;思路1：&lt;ul&gt;
&lt;li&gt;依据项目的设计流程图，一步一步进行实现&lt;/li&gt;
&lt;li&gt;遇到需要依赖于其他模块的地方，就暂停当前的模块，去实现其他模块中需要使用的功能&lt;/li&gt;
&lt;li&gt;其他模块实现后，再回来接着写当前的模块&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;思路2：&lt;ul&gt;
&lt;li&gt;先实现基础模块，这些模块不依赖于其他的模块，比如这里的：数据模型，数据库模块&lt;/li&gt;
&lt;li&gt;然后实现具体得功能模块，比如爬虫模块，检测模块，代理API模块&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;对比：&lt;ul&gt;
&lt;li&gt;思路1：按照流程一步步实现，适合一个人完成项目，流程清晰，但是不适合分工合作&lt;/li&gt;
&lt;li&gt;思路2：把项目拆分为多个相对独立的模块，每一个人实现一个模块，适合分工合作；实现项目也会更加流畅，不会有跳来跳去的现象，对最初设计要求比较高，要提前设计好后面需要用到的接口&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;代理池项目采用的实现思路&lt;ul&gt;
&lt;li&gt;这里采用 思路2来进行实现&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;4.定义代理IP的数据模型类&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;目标：定义代理IP的数据模型类&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;步骤：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;定义&lt;code&gt;Proxy&lt;/code&gt;类，继承object&lt;/li&gt;
&lt;li&gt;实现&lt;code&gt;__init__&lt;/code&gt;方法，负责初始化，包含如下字段：&lt;ul&gt;
&lt;li&gt;ip：代理的IP地址&lt;/li&gt;
&lt;li&gt;port：代理IP的端口号&lt;/li&gt;
&lt;li&gt;protocol：代理IP支持的协议类型，http是0，https是1，https和http都支持是2&lt;/li&gt;
&lt;li&gt;nick_type：代理IP的匿名程度，高匿：0，匿名：1，透明：2&lt;/li&gt;
&lt;li&gt;speed：代理IP的响应速度，单位s&lt;/li&gt;
&lt;li&gt;area：代理IP所在的地区&lt;/li&gt;
&lt;li&gt;score：代理IP的评分，用于衡量代理的可用性，默认分之可以通过配置文件进行配置，在进行代理可用性检查的时候，每遇到一次请求失败就减1分，减到0的时候就从池子中删除，如果检查代理可用，就恢复默认分值。&lt;/li&gt;
&lt;li&gt;disable_domains：不可用域名列表，有些代理IP在某些域名下不可用，但是在其他域名下可用&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;配置文件：&lt;code&gt;settings.py&lt;/code&gt; 中定义MAX_SCORE=50，表示代理IP的默认最高分数&lt;/li&gt;
&lt;li&gt;提供&lt;code&gt;__str__&lt;/code&gt;方法，返回数据字符串&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;代码：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;span class="c1"&gt;#domin.py&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;settings&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MAX_SCORE&lt;/span&gt;
&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;4.定义代理IP的数据模型类&lt;/span&gt;
&lt;span class="sd"&gt;目标：定义代理IP的数据模型类&lt;/span&gt;
&lt;span class="sd"&gt;步骤：&lt;/span&gt;

&lt;span class="sd"&gt;1.定义Proxy类，继承object&lt;/span&gt;
&lt;span class="sd"&gt;2.实现__init__方法，负责初始化，包含如下字段：&lt;/span&gt;
&lt;span class="sd"&gt;    ip：代理的IP地址&lt;/span&gt;
&lt;span class="sd"&gt;    port：代理IP的端口号&lt;/span&gt;
&lt;span class="sd"&gt;    protocol：代理IP支持的协议类型，http是0，https是1，https和http都支持是2&lt;/span&gt;
&lt;span class="sd"&gt;    nick_type：代理IP的匿名程度，高匿：0，匿名：1，透明：2&lt;/span&gt;
&lt;span class="sd"&gt;    speed：代理IP的响应速度，单位s&lt;/span&gt;
&lt;span class="sd"&gt;    area：代理IP所在的地区&lt;/span&gt;
&lt;span class="sd"&gt;    score：代理IP的评分，用于衡量代理的可用性，默认分之可以通过配置文件进行配置，在进行代理可用性检查的时候，每遇到一次请求失败就减1分，减到0的时候就从池子中删除，如果检查代理可用，就恢复默认分值。&lt;/span&gt;
&lt;span class="sd"&gt;    disable_domains：不可用域名列表，有些代理IP在某些域名下不可用，但是在其他域名下可用&lt;/span&gt;
&lt;span class="sd"&gt;    配置文件：`settings.py` 中定义MAX_SCORE=50，表示代理IP的默认最高分数&lt;/span&gt;
&lt;span class="sd"&gt;3.提供__str__方法，返回数据字符串&lt;/span&gt;

&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Proxy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ip&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;protocol&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nick_type&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;speed&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;area&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;score&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;MAX_SCORE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;disable_domain&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]):&lt;/span&gt;
        &lt;span class="c1"&gt;# ip：代理的IP地址&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ip&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ip&lt;/span&gt;
        &lt;span class="c1"&gt;# port：代理IP的端口号&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;
      &lt;span class="c1"&gt;# protocol：代理IP支持的协议类型，http是0，https是1，https和http都支持是2&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;protocol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;protocol&lt;/span&gt;
      &lt;span class="c1"&gt;# nick_type：代理IP的匿名程度，高匿：0，匿名：1，透明：2&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nick_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nick_type&lt;/span&gt;
        &lt;span class="c1"&gt;# speed：代理IP的响应速度，单位s&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;speed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;speed&lt;/span&gt;
        &lt;span class="c1"&gt;# area：代理IP所在的地区&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;area&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;area&lt;/span&gt;
        &lt;span class="c1"&gt;# score：代理IP的评分，用于衡量代理的可用性，默认分之可以通过配置文件进行配置，在进行代理可用性检查的时候，每遇到一次请求失败就减1分，减到0的时候就从池子中删除，如果检查代理可用，就恢复默认分值。&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;score&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;score&lt;/span&gt;
        &lt;span class="c1"&gt;# disable_domains：不可用域名列表，有些代理IP在某些域名下不可用，但是在其他域名下&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;disable_domain&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;disable_domain&lt;/span&gt;
        &lt;span class="c1"&gt;# 配置文件：settings.py中定义MAX_SCORE = 50，表示代理IP的默认最高分数&lt;/span&gt;

    &lt;span class="c1"&gt;# 3.提供__str__方法，返回数据字符串&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__str__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="c1"&gt;#返回数据字符串&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="vm"&gt;__dict__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#settings.py&lt;/span&gt;

&lt;span class="c1"&gt;# 配置文件：settings.py中定义MAX_SCORE = 50，表示代理IP的默认最高分数MAX_SCORE = 50&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;5.实现代理池工具模块&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;步骤&lt;ul&gt;
&lt;li&gt;实现日志模块&lt;/li&gt;
&lt;li&gt;http模块 &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;5.1实现日志模块&lt;/h5&gt;
&lt;h6&gt;5.1.1.为什么要实现日志模块&lt;/h6&gt;
&lt;ul&gt;
&lt;li&gt;能够方便的对进程进行调试&lt;/li&gt;
&lt;li&gt;能够方便记录程序的运行状态&lt;/li&gt;
&lt;li&gt;能够记录错误信息&lt;/li&gt;
&lt;/ul&gt;
&lt;h6&gt;5.1.2.日志模块的实现&lt;/h6&gt;
&lt;ul&gt;
&lt;li&gt;目标：实现日志模块，用于记录日志&lt;/li&gt;
&lt;li&gt;前提：日志模块在网上有很多现成的实现，我们开发的时候，通常不会自己写，而是拿来主义。&lt;/li&gt;
&lt;li&gt;&lt;p&gt;步骤：&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;拷贝笔记日志代码到项目中&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#utils/log.py&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;logging&lt;/span&gt;

&lt;span class="c1"&gt;#默认的配置&lt;/span&gt;
&lt;span class="n"&gt;DEFAULT_LOG_LEVEL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;   &lt;span class="c1"&gt;# 默认等级&lt;/span&gt;
&lt;span class="n"&gt;DEFAULT_LOG_FMT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%(asctime)s&lt;/span&gt;&lt;span class="s1"&gt; &lt;/span&gt;&lt;span class="si"&gt;%(filename)s&lt;/span&gt;&lt;span class="s1"&gt; [line:&lt;/span&gt;&lt;span class="si"&gt;%(lineno)d&lt;/span&gt;&lt;span class="s1"&gt;] &lt;/span&gt;&lt;span class="si"&gt;%(levelname)s&lt;/span&gt;&lt;span class="s1"&gt;: &lt;/span&gt;&lt;span class="si"&gt;%(message)s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;  &lt;span class="c1"&gt;# 默认日志格式&lt;/span&gt;
&lt;span class="n"&gt;DEFUALT_LOG_DATEFMT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;%Y-%m-&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s1"&gt; %H:%M:%S&amp;#39;&lt;/span&gt;  &lt;span class="c1"&gt;# 默认时间格式&lt;/span&gt;
&lt;span class="n"&gt;DEFAULT_LOG_FILENAME&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;log.log&amp;#39;&lt;/span&gt;  &lt;span class="c1"&gt;# 默认日志文件名称&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Logger&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="c1"&gt;# 1. 获取一个logger对象&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_logger&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getLogger&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="c1"&gt;# 2. 设置format对象&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;formatter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Formatter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fmt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;DEFAULT_LOG_FMT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;datefmt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;DEFUALT_LOG_DATEFMT&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="c1"&gt;# 3. 设置日志输出&lt;/span&gt;
        &lt;span class="c1"&gt;# 3.1 设置文件日志模式&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;addHandler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_get_file_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;DEFAULT_LOG_FILENAME&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="c1"&gt;# 3.2 设置终端日志模式self._logger.addHandler(self._get_console_handler())&lt;/span&gt;
        &lt;span class="c1"&gt;# 4. 设置日志等级&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setLevel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;DEFAULT_LOG_LEVEL&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_get_file_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="sd"&gt;&amp;#39;&amp;#39;&amp;#39;返回一个文件日志handler&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
        &lt;span class="c1"&gt;# 1. 获取一个文件日志handler&lt;/span&gt;
        &lt;span class="n"&gt;filehandler&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FileHandler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;utf-8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="c1"&gt;# 2. 设置日志格式&lt;/span&gt;
        &lt;span class="n"&gt;filehandler&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setFormatter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;formatter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="c1"&gt;# 3. 返回&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;filehandler&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_get_console_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="sd"&gt;&amp;#39;&amp;#39;&amp;#39;返回一个输出到终端日志handler&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
        &lt;span class="c1"&gt;# 1. 获取一个输出到终端日志handler&lt;/span&gt;
        &lt;span class="n"&gt;console_handler&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StreamHandler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="c1"&gt;# 2. 设置日志格式&lt;/span&gt;
        &lt;span class="n"&gt;console_handler&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setFormatter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;formatter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="c1"&gt;# 3. 返回handler&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;console_handler&lt;/span&gt;

    &lt;span class="nd"&gt;@property&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;logger&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_logger&lt;/span&gt;
&lt;span class="c1"&gt;# 初始化并配一个logger对象，达到单例的&lt;/span&gt;
&lt;span class="c1"&gt;# 使用时，直接导入logger就可以使用&lt;/span&gt;
&lt;span class="n"&gt;logger&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Logger&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logger&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;调试信息&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;状态信息&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;warning&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;警告信息&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;错误信息&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;critical&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;严重错误信息&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;把日志相关配置信息放到配置文件中&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#settings.py&lt;/span&gt;
&lt;span class="n"&gt;MAX_SCORE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;

&lt;span class="c1"&gt;#日志的配置信息&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;logging&lt;/span&gt;

&lt;span class="c1"&gt;#默认的配置&lt;/span&gt;
&lt;span class="n"&gt;DEFAULT_LOG_LEVEL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;   &lt;span class="c1"&gt;# 默认等级&lt;/span&gt;
&lt;span class="n"&gt;DEFAULT_LOG_FMT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%(asctime)s&lt;/span&gt;&lt;span class="s1"&gt; &lt;/span&gt;&lt;span class="si"&gt;%(filename)s&lt;/span&gt;&lt;span class="s1"&gt; [line:&lt;/span&gt;&lt;span class="si"&gt;%(lineno)d&lt;/span&gt;&lt;span class="s1"&gt;] &lt;/span&gt;&lt;span class="si"&gt;%(levelname)s&lt;/span&gt;&lt;span class="s1"&gt;: &lt;/span&gt;&lt;span class="si"&gt;%(message)s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;  &lt;span class="c1"&gt;# 默认日志格式&lt;/span&gt;
&lt;span class="n"&gt;DEFUALT_LOG_DATEFMT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;%Y-%m-&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s1"&gt; %H:%M:%S&amp;#39;&lt;/span&gt;  &lt;span class="c1"&gt;# 默认时间格式&lt;/span&gt;
&lt;span class="n"&gt;DEFAULT_LOG_FILENAME&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;log.log&amp;#39;&lt;/span&gt;  &lt;span class="c1"&gt;# 默认日志文件名称&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;修改日志代码，使用配置文件中的配置信息&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;logging&lt;/span&gt;

&lt;span class="c1"&gt;#导入settingss中日志配置信息&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;settings&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;DEFAULT_LOG_FMT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DEFUALT_LOG_DATEFMT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DEFAULT_LOG_FILENAME&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DEFAULT_LOG_LEVEL&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h5&gt;5.2. http模块&lt;/h5&gt;
&lt;p&gt;我们从代理IP网站上抓取代理IP和检验代理IP的时候，为了不容易被服务器识别为一个爬虫，我们最好提供随机的User-Agent请求头。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;目标：获取随机User-Agent的请求头&lt;/li&gt;
&lt;li&gt;步骤：&lt;ul&gt;
&lt;li&gt;准备User-Agent的列表&lt;/li&gt;
&lt;li&gt;实现一个方法，获取随机User-Agent的请求头&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;代码：&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#-*- coding:utf-8 -*-&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;random&lt;/span&gt;
&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;5.2. http模块&lt;/span&gt;

&lt;span class="sd"&gt;我们从代理IP网站上抓取代理IP和检验代理IP的时候，为了不容易被服务器识别为一个爬虫，我们最好提供随机的User-Agent请求头。&lt;/span&gt;

&lt;span class="sd"&gt;目标：获取随机User-Agent的请求头&lt;/span&gt;
&lt;span class="sd"&gt;步骤：&lt;/span&gt;
&lt;span class="sd"&gt;    1.准备User-Agent的列表&lt;/span&gt;
&lt;span class="sd"&gt;    2.实现一个方法，获取随机User-Agent的请求头&lt;/span&gt;
&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;#1.准备User-Agent列表&lt;/span&gt;
&lt;span class="n"&gt;USER_AGENTS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (Windows; U; Windows NT 6.1; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; .NET4.0C; .NET4.0E; .NET CLR 2.0.50727; .NET CLR 3.0.30729; .NET CLR 3.5.30729; InfoPath.3; rv:11.0) like Gecko&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:2.0.1) Gecko/20100101 Firefox/4.0.1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (Windows NT 6.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; en) Presto/2.8.131 Version/11.11&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Opera/9.80 (Windows NT 6.1; U; en) Presto/2.8.131 Version/11.11&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_0) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Maxthon 2.0)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; TencentTraveler 4.0)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; The World)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SE 2.X MetaSr 1.0; SE 2.X MetaSr 1.0; .NET CLR 2.0.50727; SE 2.X MetaSr 1.0)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; 360SE)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Avant Browser)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_3 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (iPod; U; CPU iPhone OS 4_3_3 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (iPad; U; CPU OS 4_3_3 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (Linux; U; Android 2.3.7; en-us; Nexus One Build/FRF91) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;MQQBrowser/26 Mozilla/5.0 (Linux; U; Android 2.3.7; zh-cn; MB200 Build/GRJ22; CyanogenMod-7) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Opera/9.80 (Android 2.3.4; Linux; Opera Mobi/build-1107180945; U; en-GB) Presto/2.8.149 Version/11.10&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (Linux; U; Android 3.0; en-us; Xoom Build/HRI39) AppleWebKit/534.13 (KHTML, like Gecko) Version/4.0 Safari/534.13&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (BlackBerry; U; BlackBerry 9800; en) AppleWebKit/534.1+ (KHTML, like Gecko) Version/6.0.0.337 Mobile Safari/534.1+&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (hp-tablet; Linux; hpwOS/3.0.0; U; en-US) AppleWebKit/534.6 (KHTML, like Gecko) wOSBrowser/233.70 Safari/534.6 TouchPad/1.0&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (SymbianOS/9.4; Series60/5.0 NokiaN97-1/20.0.019; Profile/MIDP-2.1 Configuration/CLDC-1.1) AppleWebKit/525 (KHTML, like Gecko) BrowserNG/7.1.18124&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (compatible; MSIE 9.0; Windows Phone OS 7.5; Trident/5.0; IEMobile/9.0; HTC; Titan)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;UCWEB7.0.2.37/28/999&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;NOKIA5700/ UCWEB7.0.2.37/28/999&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Openwave/ UCWEB7.0.2.37/28/999&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/4.0 (compatible; MSIE 6.0; ) Opera/UCWEB7.0.2.37/28/999&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="c1"&gt;# iPhone 6：&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;Mozilla/6.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/8.0 Mobile/10A5376e Safari/8536.25&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;


&lt;span class="c1"&gt;#2.实现一个方法，获取随机User-Agent的请求头&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_request_headers&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;headers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;User-Agent&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;choice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;USER_AGENTS&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;Accept&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;Accept-language&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;zh-CN,zh;q=0.9&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;Accept-Encoding&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;gzip, deflate,br&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;Connection&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;keep-alive&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;headers&lt;/span&gt;


&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c1"&gt;# 测试随机与否&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;get_request_headers&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;get_request_headers&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;6.实现代理池的校验模块&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;目标：检验代理IP速度，匿名程度以及支持的协议类型&lt;/li&gt;
&lt;li&gt;步骤：&lt;ul&gt;
&lt;li&gt;代理IP速度，就是从发送请求到获取响应的时间间隔&lt;/li&gt;
&lt;li&gt;检验代理IP速度和匿名程度：&lt;ul&gt;
&lt;li&gt;匿名程度检查：&lt;ul&gt;
&lt;li&gt;对&lt;a href="http://httpbin.org/get"&gt;http://httpbin.org/get&lt;/a&gt;  或 &lt;a href="https://httpbin.org/get"&gt;https://httpbin.org/get&lt;/a&gt; 发送请求&lt;/li&gt;
&lt;li&gt;如果响应origin中有',' 分割的两个IP就是透明代理IP&lt;/li&gt;
&lt;li&gt;如果响应的headers中包含Proxy-Connection 说明是匿名代理IP&lt;/li&gt;
&lt;li&gt;否则就是高匿名IP&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;检查代理IP协议类型&lt;ul&gt;
&lt;li&gt;如果 &lt;a href="http://httpbin.org/get"&gt;http://httpbin.org/get&lt;/a&gt; 发送请求可以成功，说明支持http协议&lt;/li&gt;
&lt;li&gt;如果 &lt;a href="https://httpbin.org/get"&gt;https://httpbin.org/get&lt;/a&gt; 发送请求可以成功，说明支持https协议&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;代码 &lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#httpbin_validator.py&lt;/span&gt;
&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;6.实现代理池的校验模块&lt;/span&gt;
&lt;span class="sd"&gt;目标：检验代理IP速度，匿名程度以及支持的协议类型&lt;/span&gt;
&lt;span class="sd"&gt;步骤：&lt;/span&gt;

&lt;span class="sd"&gt;检验代理IP速度和匿名程度：&lt;/span&gt;
&lt;span class="sd"&gt;    1.代理IP速度，就是从发送请求到获取响应的时间间隔&lt;/span&gt;
&lt;span class="sd"&gt;    2.匿名程度检查：&lt;/span&gt;
&lt;span class="sd"&gt;        1.对http://httpbin.org/get  或 https://httpbin.org/get 发送请求&lt;/span&gt;
&lt;span class="sd"&gt;        2.如果响应origin中有&amp;#39;,&amp;#39; 分割的两个IP就是透明代理IP&lt;/span&gt;
&lt;span class="sd"&gt;        3.如果响应的headers中包含Proxy-Connection 说明是匿名代理IP&lt;/span&gt;
&lt;span class="sd"&gt;        4.否则就是高匿名IP&lt;/span&gt;
&lt;span class="sd"&gt;检查代理IP协议类型&lt;/span&gt;
&lt;span class="sd"&gt;    如果 http://httpbin.org/get 发送请求可以成功，说明支持http协议&lt;/span&gt;
&lt;span class="sd"&gt;    如果 https://httpbin.org/get 发送请求可以成功，说明支持https协议&lt;/span&gt;

&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;json&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;domain&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Proxy&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;utils.http&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;get_request_headers&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;settings&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TEST_TIMEOUT&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;utils.log&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;logger&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;check_proxy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    用于检查指定 代理IP  响应速度  匿名程度  支持协议类型&lt;/span&gt;
&lt;span class="sd"&gt;    :param proxy:代理IP模型对象&lt;/span&gt;
&lt;span class="sd"&gt;    :return:检查后的代理IP模型对象&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

    &lt;span class="c1"&gt;#准备代理IP字典&lt;/span&gt;
    &lt;span class="n"&gt;proxies&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;http&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;http://&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;:&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;.format(proxy.ip, proxy.port)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;https&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;:&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;.format(proxy.ip, proxy.port)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="c1"&gt;#测试该代理IP&lt;/span&gt;
    &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;http_nick_type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;http_speed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;__check_http_proxies&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;proxies&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;https_nick_type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;https_speed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;__check_http_proxies&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;proxies&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;#代理IP支持的协议类型，http是0， https是1， http和https都支持是2&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;protocol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
        &lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nick_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;http_nick_type&lt;/span&gt;
        &lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;speed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;http_speed&lt;/span&gt;
    &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;protocol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nick_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;http_nick_type&lt;/span&gt;
        &lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;speed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;http_speed&lt;/span&gt;
    &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;protocol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nick_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;https_nick_type&lt;/span&gt;
        &lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;speed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;https_speed&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;protocol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nick_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;speed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;proxy&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__check_http_proxies&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;proxies&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;is_http&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;#匿名类型： 高匿：0， 匿名：1， 透明：2&lt;/span&gt;
    &lt;span class="n"&gt;nick_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="c1"&gt;#响应速度，单位s&lt;/span&gt;
    &lt;span class="n"&gt;speed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;is_http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;test_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;http://httpbin.org/get&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;test_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://httpbin.org/get&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="c1"&gt;#获取开始时间&lt;/span&gt;
        &lt;span class="n"&gt;start&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="c1"&gt;#发送请求，获取响应速度&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test_url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;get_request_headers&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;proxies&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;proxies&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;TEST_TIMEOUT&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ok&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="c1"&gt;#计算响应速度&lt;/span&gt;
            &lt;span class="n"&gt;speed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="c1"&gt;#匿名程度&lt;/span&gt;
            &lt;span class="c1"&gt;#把响应的json字符串转换成字典&lt;/span&gt;
            &lt;span class="n"&gt;dic&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loads&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="c1"&gt;#获取来源IP:origin&lt;/span&gt;
            &lt;span class="n"&gt;origin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dic&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;origin&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="n"&gt;proxy_connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dic&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;headers&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Proxy-Connection&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="c1"&gt;# 1.如果响应origin中有&amp;#39;,&amp;#39; 分割的两个IP就是透明代理IP&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;origin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;nick_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
            &lt;span class="c1"&gt;# 2.如果响应的headers中包含Proxy-Connection 说明是匿名代理IP&lt;/span&gt;
            &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;proxy_connection&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;nick_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
            &lt;span class="c1"&gt;# 3.否则就是高匿名IP&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;nick_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nick_type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;speed&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nick_type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;speed&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="c1"&gt;#logger.exception(ex)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nick_type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;speed&lt;/span&gt;

&lt;span class="c1"&gt;#测试是否可用&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;proxy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Proxy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;45.76.162.126&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;8080&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;check_proxy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;#settings.py
#测试代理IP的超时时间
TEST_TIMEOUT = 10&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;7.实现代理池的数据库模块&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;作用：用于对proxies集合进行数据库的相关 操作&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;目标：实现对数据库增删改查相关操作&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;步骤：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在&lt;code&gt;__init__&lt;/code&gt;中，建立数据连接，获取要操作的集合，在&lt;code&gt;__del__&lt;/code&gt;方法中关闭数据库连接&lt;/li&gt;
&lt;li&gt;提供基础的增删改查功能&lt;ul&gt;
&lt;li&gt;实现插入功能&lt;/li&gt;
&lt;li&gt;实现修改功能&lt;/li&gt;
&lt;li&gt;实现删除代理：根据代理的IP删除代理&lt;/li&gt;
&lt;li&gt;查询所有代理IP的功能&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;代码&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;```python
#mongo_pool.py&lt;/p&gt;
&lt;p&gt;from pymongo import MongoClient  #&lt;a href="http://www.imooc.com/article/43478"&gt;http://www.imooc.com/article/43478&lt;/a&gt;
from settings import MONGO_URL  #&lt;a href="https://juejin.im/post/5d525b1af265da03b31bc2d5"&gt;https://juejin.im/post/5d525b1af265da03b31bc2d5&lt;/a&gt;
from utils.log import logger
from domain import Proxy&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;class MongoPool(object):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  def __init__(self):
      #在 int中，建立数据连接，获取要操作的集合
      self.client = MongoClient(MONGO_URL)
      #获取要操作的集合
      self.proxies = self.client['proxies_pool']['proxies']

  def __del__(self):
      #关闭数据库连接
      self.client.close()

  def inser_one(self, proxy):
      """实现插入功能"""

      count = self.proxies.count_documents({'_id':proxy.ip})
      if count == 0:
          #我们使用proxy.ip作为MongoDB的主键： _id
          dic = proxy.__dict__
          dic['_id'] = proxy.ip
          self.proxies.insert_one(dic)
          logger.info("插入新的代理：{}".format(proxy))
      else:
          logger.warning("已存在的代理：{}".format(proxy))

  def update_one(self, proxy):
      """实现修改功能"""
      self.proxies.update_one({'_id': proxy.ip}, {'$set': proxy.__dict__})
      logger.warning("代理更新：{}".format(proxy))

  def delete_one(self, proxy):
      """实现删除代理，根据代理的IP删除代理"""
      self.proxies.delete_one({'_id':proxy.ip})
      logger.info("删除代理IP:{}".format(proxy))

  def find_all(self):
      """查询所有代理IP的功能"""
      cursor = self.proxies.find()
      for item in cursor:
          #删除_id这个key
          item.pop('_id')
          proxy = Proxy(**item)
          yield proxy

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;if &lt;strong&gt;name&lt;/strong&gt; == '&lt;strong&gt;main&lt;/strong&gt;':   #测试是否可用
      mongo = MongoPool()
      proxy = Proxy('202.104.113.36', port='53281')
      mongo.inser_one(proxy)
      mongo.update_one(proxy)
      mongo.delete_one(proxy)
      for proxy in mongo.find_all():
          print(proxy)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
  ```python
  #settings.py
  #MongoDB数据库的URL
  MONGO_URL = 'mongodb://127.0.0.1:27017'&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;提供代理API模块使用的功能&lt;ul&gt;
&lt;li&gt;实现查询功能：根据条件进行查询 ，可以指定查询数量，先分数降序，速度升序，保证优质的代理IP在上面&lt;/li&gt;
&lt;li&gt;实现根据协议类型和要访问网站的域名，获取代理IP列表&lt;/li&gt;
&lt;li&gt;实现根据协议类型和要访问完整的域名，随机获取一个代理IP&lt;/li&gt;
&lt;li&gt;实现把指定域名添加到指定IP的disable_domain列表中&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description><author>kansha_liu@foxmail.com (Kanshan)</author><guid isPermaLink="true">https://liukanshan.club/archives/2020-05-09-Proxy_Pool/</guid><pubDate>Sat, 09 May 2020 20:10:00 +0806</pubDate></item></channel></rss>